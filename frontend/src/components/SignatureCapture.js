import React,{useRef,useState} from 'react';import{Box,Button,Paper,Typography,Card,CardContent,CardHeader,Grid,Alert,Dialog,DialogTitle,DialogContent,DialogActions}from '@mui/material';import{Clear,Check,Download,Upload}from '@mui/icons-material';const SC=({onSave,readOnly=false})=>{const ref=useRef(null);const[drawing,setDrawing]=useState(false);const[sig,setSig]=useState(null);const[sigs,setSigs]=useState([{id:1,name:'Alice',date:'2024-12-15',time:'14:30'},{id:2,name:'Bob',date:'2024-12-14',time:'09:15'},{id:3,name:'Carol',date:'2024-12-13',time:'16:45'}]);const start=()=>setDrawing(true);const stop=()=>setDrawing(false);const draw=e=>{if(!drawing||readOnly)return;const c=ref.current;const ctx=c.getContext('2d');const r=c.getBoundingClientRect();ctx.lineTo(e.clientX-r.left,e.clientY-r.top);ctx.stroke();};const clear=()=>{const c=ref.current;const ctx=c.getContext('2d');ctx.clearRect(0,0,c.width,c.height);setSig(null);};const save=()=>{const c=ref.current;const img=c.toDataURL('image/png');setSig(img);setSigs([...sigs,{id:Math.max(...sigs.map(s=>s.id),0)+1,name:'New',date:new Date().toLocaleDateString(),time:new Date().toLocaleTimeString()}]);if(onSave)onSave(img);};const download=()=>{if(sig){const a=document.createElement('a');a.href=sig;a.download='sig.png';a.click();}};return<Box><Grid container spacing={3}><Grid item xs={12} md={6}><Card><CardHeader title="Signature" sx={{backgroundColor:'#1976d2',color:'#fff'}}/><CardContent>{!readOnly&&<Alert severity="info" sx={{mb:2}}>Click to sign</Alert>}<Paper sx={{border:'2px solid #1976d2',mb:2}}><canvas ref={ref} onMouseDown={start} onMouseUp={stop} onMouseMove={draw} width={300} height={150} style={{cursor:readOnly?'default':'crosshair',backgroundColor:'#fff',display:'block'}}/></Paper>{!readOnly&&<Box sx={{display:'flex',gap:1}}><Button variant="outlined" color="error" startIcon={<Clear/>} onClick={clear} fullWidth>Clear</Button><Button variant="contained" startIcon={<Check/>} onClick={save} fullWidth sx={{backgroundColor:'#1976d2'}}>Save</Button></Box>}{sig&&<Button variant="outlined" startIcon={<Download/>} onClick={download} fullWidth sx={{mt:1}}>Download</Button>}</CardContent></Card></Grid><Grid item xs={12} md={6}><Card><CardHeader title="History" sx={{backgroundColor:'#1976d2',color:'#fff'}}/><CardContent>{sigs.map(s=><Box key={s.id} sx={{p:1.5,mb:1,backgroundColor:'#f5f5f5',borderRadius:1,display:'flex',justifyContent:'space-between',alignItems:'center'}}><Box><Typography sx={{fontWeight:'bold'}}>{s.name}</Typography><Typography variant="caption" sx={{color:'#666'}}>{s.date} {s.time}</Typography></Box><Button size="small" variant="outlined">View</Button></Box>)}</CardContent></Card></Grid></Grid></Box>;};export default SC;
